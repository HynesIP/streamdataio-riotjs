<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Stockmarket sample</title>

        <link rel="stylesheet" type="text/css" href="../node_modules/bootstrap/dist/css/bootstrap.min.css" />

        <link rel="stylesheet" type="text/css" href="css/main.css" />
        <link rel="stylesheet" type="text/css" href="css/stockmarket-barchart.css" />
    </head>
    <body>
        <!-- mount point -->
        <stockmarket-button></stockmarket-button>
        <stockmarket-table></stockmarket-table>
        <stockmarket-barchart height="500" width="960"></stockmarket-barchart>
        <!--<stockmarket-barchart height=300 width=760 chart_id="chart-2"></stockmarket-barchart>-->

        <!-- include riot.js -->
        <script src="../node_modules/riot/riot.min.js"></script>

        <script src="../node_modules/d3/build/d3.min.js"></script>

        <script src="../app/js/stockmarket-service.js"></script>
        <script src="../dist/js/stockmarket-button.js"></script>
        <script src="../dist/js/stockmarket-table.js"></script>
        <script src="../dist/js/stockmarket-barchart.js"></script>

        <script>
            var bus = riot.observable();
            var stockMarketService = new StockMarketService(bus);
            var areMounted = false;

            riot.mount('stockmarket-button', {title: 'Load Stocks', stockMarketService: stockMarketService});

            bus.on('newStocksEvent', function (param) {
                if (!areMounted) {
                    riot.mount('stockmarket-table', {title: 'Stocks', bus: bus, stocks: param.stocks});
                    riot.mount('stockmarket-barchart', {title: 'Graph', bus:bus, stocks: param.stocks});
                    areMounted = true;
                }
            });
        </script>
    </body>
</html>